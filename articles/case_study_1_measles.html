<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Paper case study 1: One pathogen system with vaccination (Measles) • serosim</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Paper case study 1: One pathogen system with vaccination (Measles)">
<meta property="og:description" content="serosim">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">serosim</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/case_study_1_measles.html">Paper case study 1: One pathogen system with vaccination (Measles)</a>
    </li>
    <li>
      <a href="../articles/case_study_2_diphtheria_pertussis.html">Paper case study 2: Multi-pathogen system with multivalent vaccinaton (Diphtheria and Pertussis)</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/AMenezes97/serosim/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Paper case study 1: One pathogen system with
vaccination (Measles)</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/AMenezes97/serosim/blob/HEAD/vignettes/case_study_1_measles.Rmd" class="external-link"><code>vignettes/case_study_1_measles.Rmd</code></a></small>
      <div class="hidden name"><code>case_study_1_measles.Rmd</code></div>

    </div>

    
    
<p>Here, we will use the <em>serosim</em> package to generate a
longitudinal serological survey of a one pathogen system with
vaccination and natural infection. The overall structure and principles
discussed within this case study are also applicable to other vaccine
preventable pathogens. In this simulation, individuals can either be
vaccinated against the pathogen, naturally infected with the pathogen, a
combination of both or neither. We will set up each of the required
arguments and models for <em>runserosim</em> in the order outlined in
the methods section of the paper.</p>
<p>This case study is built around measles and we are interested in
tracking measles vaccination and infection across a 10 year period. We
will conduct a longitudinal serological survey with two sampling times
where we will use an ELISA kit to measure an individual’s measles IgG
titer. In this example, biomarker quantity, titer level and antibody
level all mean the same thing.</p>
<p>We will use previously conducted measles serological surveys and any
well characterized epidemiological and immunological characteristics of
measles to parameterize our models wherever possible and make reasonable
assumptions for other required model parameters wherever information is
lacking.</p>
<p>We narrowed our search to measles serological surveys conducted with
the Enzygnost ELISA IgG test kits and utilized a measles serology review
to select a few studies of relevance <span class="citation">(<a href="#ref-Thompson2016-ek" role="doc-biblioref">Thompson and Odahowski
2016</a>)</span>. We did not conduct an extensive search of all measles
serological surveys in order to parameterize our models as it is beyond
the scope of this case study. Our aim was to provide a simple example of
how users can use the literature to inform required <em>serosim</em>
inputs. Within each section below, we will briefly explain the rationale
behind our selected model inputs. We caution users to conduct their own
research into the models and associated parameters which best align with
their disease system and biomarker test kits.</p>
<p>Load necessary packages:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Install and load serosim </span></span>
<span><span class="co">## devtools::install_github("AMenezes97/serosim")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/AMenezes97/serosim" class="external-link">serosim</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Load additional packages required </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/reshape" class="external-link">reshape2</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="simulation-settings">1.1 Simulation Settings<a class="anchor" aria-label="anchor" href="#simulation-settings"></a>
</h2>
<p>We will simulate monthly time steps across a 10 year period.
Therefore, we will have 120 time steps. Note that these are arbitrary
time steps which will need to be scaled to the right time resolution to
match any time-based parameters used later on.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Specify the number of time periods to simulate </span></span>
<span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">120</span>,by<span class="op">=</span><span class="fl">1</span><span class="op">)</span> </span>
<span></span>
<span><span class="co">## Set simulation settings</span></span>
<span><span class="va">simulation_settings</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"t_start"</span><span class="op">=</span><span class="fl">1</span>,<span class="st">"t_end"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="population-demography">1.2 Population Demography<a class="anchor" aria-label="anchor" href="#population-demography"></a>
</h2>
<p>For this case study, we are not interested in tracking any demography
information but we are interested in tracking individual’s birth time.
We will use the generate_pop_demography function to create the
demography tibble needed for <em>runserosim</em> .</p>
<p>Note: The <em>runserosim</em> function, called later on, only
requires a demography tibble with two columns (individuals and
times).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Specify the number of individuals in the simulation </span></span>
<span><span class="va">N</span><span class="op">&lt;-</span><span class="fl">100</span></span>
<span></span>
<span><span class="co">## Generate the population demography tibble</span></span>
<span><span class="co">## See help file(?generate_pop_demography) for more information on function arguments.</span></span>
<span><span class="co">## age_min is set to 0 which allows births to occur until the last time step</span></span>
<span><span class="co">## Let's assume that no individuals are removed from the population and set prob_removal to 0</span></span>
<span><span class="va">demography</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_pop_demography.html">generate_pop_demography</a></span><span class="op">(</span><span class="va">N</span>, <span class="va">times</span>, age_min<span class="op">=</span><span class="fl">0</span>, prob_removal<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Joining with `by = join_by(i)`</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Examine the generated demography tibble</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">demography</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##        i              birth           removal        times       </span></span>
<span><span class="co">##  Min.   :  1.00   Min.   :  2.00   Min.   :121   Min.   :  1.00  </span></span>
<span><span class="co">##  1st Qu.: 25.75   1st Qu.: 30.00   1st Qu.:121   1st Qu.: 30.75  </span></span>
<span><span class="co">##  Median : 50.50   Median : 62.00   Median :121   Median : 60.50  </span></span>
<span><span class="co">##  Mean   : 50.50   Mean   : 60.31   Mean   :121   Mean   : 60.50  </span></span>
<span><span class="co">##  3rd Qu.: 75.25   3rd Qu.: 93.00   3rd Qu.:121   3rd Qu.: 90.25  </span></span>
<span><span class="co">##  Max.   :100.00   Max.   :118.00   Max.   :121   Max.   :120.00</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="exposure-to-biomarker-mapping">1.3 Exposure to biomarker mapping<a class="anchor" aria-label="anchor" href="#exposure-to-biomarker-mapping"></a>
</h2>
<p>Now, we have to set up the exposure IDs and biomarker IDs for our
desired simulation. Individuals can be seropositive either by measles
natural infection or by vaccination and we want to track both exposure
types separately. Here, we will simulate measles natural infection
(exposure_ID=measles_ifxn) and measles vaccination
(exposure_ID=measles_vacc) both of which will boost the same biomarker,
IgG antibodies (biomarker_ID=measles_IgG). Since we are only interested
in tracking measles IgG antibody levels across time, we only need one
biomarker ID. <em>runserosim</em> requires that exposure_id and
biomarker_id are numeric so we will use the reformat_biomarker_map
function to create a new version of the biomarker map. Users can go
directly to numeric biomarker_map if they wish.</p>
<p>Note that the reformat_biomarker_map function will number the
exposures and biomarkers in alphabetical order so that the first
exposure event or biomarker that is listed will not necessarily be
labeled as 1.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create biomarker map</span></span>
<span><span class="va">biomarker_map_original</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>exposure_id<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"measles_ifxn"</span>,<span class="st">"measles_vacc"</span><span class="op">)</span>,biomarker_id<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"measles_IgG"</span>,<span class="st">"measles_IgG"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">biomarker_map_original</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 2 × 2</span></span></span>
<span><span class="co">##   exposure_id  biomarker_id</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> measles_ifxn measles_IgG </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> measles_vacc measles_IgG</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Reformat biomarker_map for runserosim</span></span>
<span><span class="va">biomarker_map</span> <span class="op">&lt;-</span><span class="fu"><a href="../reference/reformat_biomarker_map.html">reformat_biomarker_map</a></span><span class="op">(</span><span class="va">biomarker_map_original</span><span class="op">)</span></span>
<span><span class="va">biomarker_map</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 2 × 2</span></span></span>
<span><span class="co">##   exposure_id biomarker_id</span></span>
<span><span class="co">##         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>           1            1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>           2            1</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="force-of-exposure-and-exposure-model">1.4 Force of Exposure and Exposure Model<a class="anchor" aria-label="anchor" href="#force-of-exposure-and-exposure-model"></a>
</h2>
<p>Now, we need to specify the foe_pars argument which contains the
force of exposure for all exposure_IDs across all time steps and groups.
We also specify the exposure model which will be called within
<em>runserosim</em> later. The exposure model will determine the
probability that an individual is exposed to a specific exposure
event.</p>
<p>Since we did not specify different groups within demography, all
individuals will automatically be assigned group 1. Therefore, we only
need 1 row for dimension 1 in foe_pars. Dimension 3 of the foe_array
must be in the same order as the exposure_id within the biomarker map.
For example, the force of exposure for exposure_id 1 will be inputted
within the foe_pars[,,1].</p>
<p>We specified the same force of exposure for all time steps within
foe_pars for simplicity but users will likely have varying numbers to
match real world settings.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create an empty array to store the force of exposure for all exposure types</span></span>
<span><span class="co">## Dimension 1: Group</span></span>
<span><span class="co">## Dimension 2: Times</span></span>
<span><span class="co">## Dimension 3: Exposure ID </span></span>
<span><span class="va">foe_pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fl">0</span>, dim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span>,<span class="fu"><a href="https://dplyr.tidyverse.org/reference/n_distinct.html" class="external-link">n_distinct</a></span><span class="op">(</span><span class="va">biomarker_map</span><span class="op">$</span><span class="va">exposure_id</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Specify the force of exposure for exposure ID 1 which represents measles natural infection</span></span>
<span><span class="va">foe_pars</span><span class="op">[</span>,,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.02</span></span>
<span></span>
<span><span class="co">## Specify the force of exposure for exposure ID 2 which represents measles vaccination</span></span>
<span><span class="va">foe_pars</span><span class="op">[</span>,,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.04</span></span>
<span></span>
<span><span class="co">## Specify a simple exposure model which calculates the probability of exposure directly from the force of exposure at that time step</span></span>
<span><span class="va">exposure_model</span><span class="op">&lt;-</span><span class="va">exposure_model_simple_FOE</span></span>
<span><span class="co">## In this selected model, the probability of exposure is 1-exp(-FOE) where FOE is the force of exposure at that time.</span></span>
<span></span>
<span><span class="co">## Examine the probability of exposure over time for the specified exposure model</span></span>
<span><span class="fu"><a href="../reference/plot_exposure_model.html">plot_exposure_model</a></span><span class="op">(</span>exposure_mode<span class="op">=</span><span class="va">exposure_model_simple_FOE</span>, times<span class="op">=</span><span class="va">times</span>, n_groups <span class="op">=</span> <span class="fl">1</span>, n_exposures <span class="op">=</span> <span class="fl">2</span>, foe_pars<span class="op">=</span><span class="va">foe_pars</span><span class="op">)</span></span></code></pre></div>
<p><img src="case_study_1_measles_files/figure-html/unnamed-chunk-6-1.png" width="384"></p>
</div>
<div class="section level2">
<h2 id="immunity-model">1.5 Immunity Model<a class="anchor" aria-label="anchor" href="#immunity-model"></a>
</h2>
<p>Here, we specify the immunity model which will determine the
probability that an exposure event is successful in producing an
immunological response. Since we have both vaccination and natural
infection events, we will use immunity_model_vacc_ifxn_biomarker_prot.
With this immunity model, the probability of successful measles
vaccination exposure depends on the number of measles vaccines received
prior to time t and the individual’s age at time t while the probability
of successful measles infection is dependent on the biomarker quantity,
in this case antibody titer, at the time of exposure and an individual’s
total number of measles infections.</p>
<p>Since measles is a fully immunizing pathogen, we have assumed that
individuals can only be infected once. Therefore, we have disregarded
any complexities brought on by boosting events from additional measles
exposure. This assumption can be loosened by removing the limit on
infection events.</p>
<p>Within this selected immunity model, individuals can become infected
despite prior vaccination if their current biomarker quantity is below
the threshold of protection as a result of waning or incomplete immunity
following vaccination. The biomarker quantity mediated protection
parameters (also known as titer-mediated protection) used within this
immunity model are defined within model_pars which will be loaded in
section 1.6.</p>
<p>The Enzygnost ELISA kit reports that the threshold of seropositivity
is 200 mIU/ml and we have used this titer value to inform our
titer-mediated protection curve. In our simulation, individuals with
titers below 200 mIU/ml will have a higher probability of becoming
infected when exposed to measles while individuals with titers above 200
mIU/ml are more likely to be protected from infection. It is important
to note that, seropositivty and titer level is not a perfect correlate
of protection against infection as it does not directly account for
neutralizing titers, cellular immunity and other immunological
complexities. With a more in-depth literature review on correlates of
protection, we expect users will be able to select better titer-mediated
protection parameters than our crude estimates.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Specify immunity model within runserosim function below </span></span>
<span><span class="va">immunity_model</span><span class="op">&lt;-</span><span class="va">immunity_model_vacc_ifxn_biomarker_prot</span></span>
<span><span class="co">## This immunity model requires 3 additional arguments specified below. </span></span>
<span></span>
<span><span class="co">## Specify which exposure IDs represent vaccination events </span></span>
<span><span class="va">vacc_exposures</span><span class="op">&lt;-</span><span class="fl">2</span></span>
<span></span>
<span><span class="co">## Specify the age at which an individual is eligible for measles vaccination (9 months old); note non vaccine exposures are listed as NAs</span></span>
<span><span class="va">vacc_age</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fl">9</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Specify the maximum number of successful exposure events an individual can receive for each exposure type</span></span>
<span><span class="co">## For this example, we are assuming that there is only one dose of the measles vaccine and one possible measles infection</span></span>
<span><span class="va">max_events</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Plot biomarker-mediated protection curve (also known as titer-mediated protection) given parameters specified within model_pars for biomarker 1 (measles_IgG) which will be loaded in section 1.6</span></span>
<span><span class="fu"><a href="../reference/plot_biomarker_mediated_protection.html">plot_biomarker_mediated_protection</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">1000</span>, biomarker_prot_midpoint<span class="op">=</span><span class="fl">200</span>, biomarker_prot_width<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="case_study_1_measles_files/figure-html/unnamed-chunk-7-1.png" width="384"></p>
</div>
<div class="section level2">
<h2 id="antibody-model-antibody-kinetics-parameters-and-draw_parameters">1.6 Antibody Model, Antibody Kinetics Parameters, and
draw_parameters<a class="anchor" aria-label="anchor" href="#antibody-model-antibody-kinetics-parameters-and-draw_parameters"></a>
</h2>
<p>Now, we specify the antibody model to be used within
<em>runserosim</em> to track antibody kinetics, or more broadly
biomarker kinetics for each biomarker produced from successful exposure
events.</p>
<p>We will be using a biphasic boosting-waning model. This model assumes
that for each exposure there is a set of long-term boost, long-term
boost waning, short-term boost, and short-term boost waning parameters.
Given varying measles antibody dynamics observed in early and late life,
we decided that a biphasic boosting-waning model was appropriate for our
purposes <span class="citation">(<a href="#ref-Carryn2019-qv" role="doc-biblioref">Carryn et al. 2019</a>; <a href="#ref-Amanna2007-pf" role="doc-biblioref">Amanna, Carlson, and
Slifka 2007</a>)</span>.</p>
<p>The antibody kinetics parameters needed for the antibody model are
pre-loaded within a csv file which will take on the argument name:
model_pars. Users can edit the csv file to modify any parameters.
<em>runserosim</em> requires that exposure_id and biomarker_id are
numeric within model_pars so we will use the reformat_biomarker_map
function again to create a new version of model_pars. Users can go
directly to numeric model_pars if they wish.</p>
<p>We selected a few measles serological surveys conducted with the
Enzygnost ELISA IgG test kits which measured titers following
vaccination to inform the vaccine induced boost and waning parameters.
From the reported quantitative measles IgG titers following vaccination,
we picked the conservative range of 2500-4500 mIU/mL for vaccine
acquired full boost. After 10 years, only the long-term boost remains
which ranges from 900-2000 mIU/mL. Therefore, the short-term boost
ranges from 1600-2500 mIU/mL <span class="citation">(<a href="#ref-Berry2017-ci" role="doc-biblioref">Berry et al. 2017</a>; <a href="#ref-Lyamuya1999-nf" role="doc-biblioref">Lyamuya et al. 1999</a>;
<a href="#ref-Carryn2019-qv" role="doc-biblioref">Carryn et al.
2019</a>; <a href="#ref-Trevisan2021-of" role="doc-biblioref">Trevisan
et al. 2021</a>)</span>. Since we are only simulating a 10 year period,
we assumed that there was minimal waning of the long-term boost for
simplicity.</p>
<p>Although there is evidence that titers following measles infection
are significantly higher than after vaccination when measured with PRNT
assays <span class="citation">(<a href="#ref-Anichini2020-jj" role="doc-biblioref">Anichini et al. 2020</a>)</span>, we were unable to
find studies that reported titer kinetics following known infection
events using Enzygnost ELISA IgG test kits. For simplicity, we will
assume that natural infection boosting parameters are 25% higher than
vaccine induced antibody boosting when measured with Enzygnost ELISA IgG
test kits which does not distinguish between neutralizing and
non-neutralizing titers.</p>
<p>Lastly, we define the draw_parameters function which determines how
each individual’s antibody kinetics parameters are simulated from the
within-host processes parameters tibble (model_pars). We will use a
function which draws parameters directly from model_pars for the
antibody model with random effects to represent individual heterogeneity
in immunological responses. Parameters are drawn randomly from a
distribution with mean and standard deviation specified within
model_pars. This draw_parameters function also incorporates biomarker
quantitiy dependent boosting (also known as titer-dependent boosting)
where an individual’s realized boost is dependent on their titer level
at the time of the exposure event.</p>
<p>There is contradictory evidence of whether there is a significant
boost after vaccinated individuals receive another measles vaccine <span class="citation">(<a href="#ref-Christenson1994-fj" role="doc-biblioref">Christenson and Böttiger 1994</a>; <a href="#ref-Trevisan2021-of" role="doc-biblioref">Trevisan et al.
2021</a>; <a href="#ref-Sasaki2019-gl" role="doc-biblioref">Sasaki et
al. 2019</a>)</span>. For simplicity, we have assumed that individuals
in this simulation are only eligible for one dose of the measles vaccine
so we can ignore multiple vaccination events.</p>
<p>Lastly, it has been reported that there is no significant boost in
titers with re-vaccination of children with naturally acquired immunity
<span class="citation">(<a href="#ref-Christenson1994-fj" role="doc-biblioref">Christenson and Böttiger 1994</a>)</span>. With
this draw parameters function, we incorporated titer-dependent boosting
which will take into account an individual’s current titer and adjust
their realized boost accordingly. We arbitrarily set the titer-dependent
boosting effects following an additional successful exposure event for
individuals above 200 mIU/mL to be only 10% of the full boost.</p>
<p>Given all of our specified parameters and models, individuals in the
simulation can only be vaccinated once and naturally infected once. If
an individual in vaccinated and their titers are below the threshold of
protection they run the risk of experiencing a natural infection where
their titers will receive a partial boost. Given the short duration (10
years) of this simulation and the vaccine associated antibody kinetics
parameters, it is unlikely that any individual who is vaccinated and
successfully immunized will reach a titer level that puts them at risk
of infection. If an individual is vaccinated following a natural
infection event, then they will also receive a partial boost.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Specify the antibody model </span></span>
<span><span class="va">antibody_model</span><span class="op">&lt;-</span><span class="va">antibody_model_biphasic</span></span>
<span></span>
<span><span class="co">## Bring in the antibody parameters needed for the antibody model</span></span>
<span><span class="co">## Note that the titer-mediated protection parameters needed for the immunity model (Section 1.5), the titer-ceiling parameters needed for draw_parameters and the observation error parameter needed for the observation model (Section 1.7) are all defined here too.</span></span>
<span><span class="va">model_pars_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"model_pars_cs1.csv"</span>, package <span class="op">=</span> <span class="st">"serosim"</span><span class="op">)</span></span>
<span><span class="va">model_pars_original</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span>file <span class="op">=</span> <span class="va">model_pars_path</span>, header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">model_pars_original</span> </span></code></pre></div>
<pre><code><span><span class="co">##     exposure_id biomarker_id                        name       mean      sd</span></span>
<span><span class="co">## 1  measles_ifxn  measles_IgG                  boost_long 1812.50000 5.5e+02</span></span>
<span><span class="co">## 2  measles_ifxn  measles_IgG                 boost_short 2562.50000 4.5e+02</span></span>
<span><span class="co">## 3  measles_ifxn  measles_IgG                   wane_long    0.00083 5.0e-05</span></span>
<span><span class="co">## 4  measles_ifxn  measles_IgG                  wane_short    0.00830 5.0e-04</span></span>
<span><span class="co">## 5  measles_ifxn  measles_IgG biomarker_ceiling_threshold  200.00000      NA</span></span>
<span><span class="co">## 6  measles_ifxn  measles_IgG  biomarker_ceiling_gradient    0.00450      NA</span></span>
<span><span class="co">## 7  measles_ifxn  measles_IgG     biomarker_prot_midpoint  200.00000      NA</span></span>
<span><span class="co">## 8  measles_ifxn  measles_IgG        biomarker_prot_width    1.00000      NA</span></span>
<span><span class="co">## 9          &lt;NA&gt;  measles_IgG                      obs_sd         NA 1.0e+02</span></span>
<span><span class="co">## 10 measles_vacc  measles_IgG                  boost_long 1450.00000 5.5e+02</span></span>
<span><span class="co">## 11 measles_vacc  measles_IgG                 boost_short 2050.00000 4.5e+02</span></span>
<span><span class="co">## 12 measles_vacc  measles_IgG                   wane_long    0.00083 5.0e-05</span></span>
<span><span class="co">## 13 measles_vacc  measles_IgG                  wane_short    0.00830 5.0e-04</span></span>
<span><span class="co">## 14 measles_vacc  measles_IgG biomarker_ceiling_threshold 1000.00000      NA</span></span>
<span><span class="co">## 15 measles_vacc  measles_IgG  biomarker_ceiling_gradient    0.00090      NA</span></span>
<span><span class="co">##    distribution</span></span>
<span><span class="co">## 1    log-normal</span></span>
<span><span class="co">## 2    log-normal</span></span>
<span><span class="co">## 3    log-normal</span></span>
<span><span class="co">## 4    log-normal</span></span>
<span><span class="co">## 5              </span></span>
<span><span class="co">## 6              </span></span>
<span><span class="co">## 7              </span></span>
<span><span class="co">## 8              </span></span>
<span><span class="co">## 9        normal</span></span>
<span><span class="co">## 10   log-normal</span></span>
<span><span class="co">## 11   log-normal</span></span>
<span><span class="co">## 12   log-normal</span></span>
<span><span class="co">## 13   log-normal</span></span>
<span><span class="co">## 14             </span></span>
<span><span class="co">## 15</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Reformat model_pars for runserosim</span></span>
<span><span class="va">model_pars</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/reformat_biomarker_map.html">reformat_biomarker_map</a></span><span class="op">(</span><span class="va">model_pars_original</span><span class="op">)</span></span>
<span><span class="va">model_pars</span></span></code></pre></div>
<pre><code><span><span class="co">##    exposure_id biomarker_id                        name       mean      sd</span></span>
<span><span class="co">## 1            1            1                  boost_long 1812.50000 5.5e+02</span></span>
<span><span class="co">## 2            1            1                 boost_short 2562.50000 4.5e+02</span></span>
<span><span class="co">## 3            1            1                   wane_long    0.00083 5.0e-05</span></span>
<span><span class="co">## 4            1            1                  wane_short    0.00830 5.0e-04</span></span>
<span><span class="co">## 5            1            1 biomarker_ceiling_threshold  200.00000      NA</span></span>
<span><span class="co">## 6            1            1  biomarker_ceiling_gradient    0.00450      NA</span></span>
<span><span class="co">## 7            1            1     biomarker_prot_midpoint  200.00000      NA</span></span>
<span><span class="co">## 8            1            1        biomarker_prot_width    1.00000      NA</span></span>
<span><span class="co">## 9           NA            1                      obs_sd         NA 1.0e+02</span></span>
<span><span class="co">## 10           2            1                  boost_long 1450.00000 5.5e+02</span></span>
<span><span class="co">## 11           2            1                 boost_short 2050.00000 4.5e+02</span></span>
<span><span class="co">## 12           2            1                   wane_long    0.00083 5.0e-05</span></span>
<span><span class="co">## 13           2            1                  wane_short    0.00830 5.0e-04</span></span>
<span><span class="co">## 14           2            1 biomarker_ceiling_threshold 1000.00000      NA</span></span>
<span><span class="co">## 15           2            1  biomarker_ceiling_gradient    0.00090      NA</span></span>
<span><span class="co">##    distribution</span></span>
<span><span class="co">## 1    log-normal</span></span>
<span><span class="co">## 2    log-normal</span></span>
<span><span class="co">## 3    log-normal</span></span>
<span><span class="co">## 4    log-normal</span></span>
<span><span class="co">## 5              </span></span>
<span><span class="co">## 6              </span></span>
<span><span class="co">## 7              </span></span>
<span><span class="co">## 8              </span></span>
<span><span class="co">## 9        normal</span></span>
<span><span class="co">## 10   log-normal</span></span>
<span><span class="co">## 11   log-normal</span></span>
<span><span class="co">## 12   log-normal</span></span>
<span><span class="co">## 13   log-normal</span></span>
<span><span class="co">## 14             </span></span>
<span><span class="co">## 15</span></span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Specify the draw_parameters function to use </span></span>
<span><span class="va">draw_parameters</span><span class="op">&lt;-</span><span class="va">draw_parameters_random_fx_biomarker_dep</span></span>
<span></span>
<span><span class="co">## Plot biomarker dependent boosting effects given parameters specified within model_pars for biomarker 1 (measles_IgG)</span></span>
<span><span class="fu"><a href="../reference/plot_biomarker_dependent_boosting.html">plot_biomarker_dependent_boosting</a></span><span class="op">(</span>start<span class="op">=</span><span class="fl">0</span>, end<span class="op">=</span><span class="fl">1000</span>, by<span class="op">=</span><span class="fl">1</span>, biomarker_ceiling_threshold<span class="op">=</span><span class="fl">200</span>, biomarker_ceiling_gradient<span class="op">=</span><span class="fl">.0045</span><span class="op">)</span></span></code></pre></div>
<p><img src="case_study_1_measles_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## These parameters indicate that any individual with a titer level above 200 mIU/mL at the time of a second exposure event will only receive 10% of the regular boosting parameter for that event. Individuals with a measles titer of 0 will receive the full boost.</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Plot example biomarker trajectories given the specified antibody kinetics model, model parameters and draw parameters function </span></span>
<span><span class="fu"><a href="../reference/plot_antibody_model.html">plot_antibody_model</a></span><span class="op">(</span><span class="va">antibody_model_biphasic</span>, N<span class="op">=</span><span class="fl">100</span>, model_pars<span class="op">=</span><span class="va">model_pars</span>,draw_parameters_fn <span class="op">=</span> <span class="va">draw_parameters_random_fx_biomarker_dep</span>, biomarker_map<span class="op">=</span><span class="va">biomarker_map</span><span class="op">)</span></span></code></pre></div>
<p><img src="case_study_1_measles_files/figure-html/unnamed-chunk-9-1.png" width="480"></p>
</div>
<div class="section level2">
<h2 id="observation-model-and-observation_times">1.7 Observation Model and observation_times<a class="anchor" aria-label="anchor" href="#observation-model-and-observation_times"></a>
</h2>
<p>Now we specify how observed biomarker quantities, in this case
antibody titers, are generated as a probabilistic function of the true,
latent biomarker quantities, and when to observe these quantities. In
this step, users are specifying the sampling design and assay choice for
their serological survey.</p>
<p>We will take paired samples of all individuals alive at the midpoint
(t=60) and end of the simulation (t=120). Our selected observation model
observes the latent titer values given a continuous assay with
user-specified lower and upper limits and added noise. Enzygnost ELISA
measles IgG kits’ lower limit of detection is 100 mIU/mL with no
reported upper limit. The added noise represents assay variability and
is implemented by sampling from a distribution with the true latent
antibody titer as the mean and the measurement error as the standard
deviation. The observation standard deviation and distribution are
defined within model_pars as the “obs_sd” parameter. Within this
observation model, we can also specify the assay sensitivity and
specificity. The Enzygnost ELISA IgG test kit has a reported 99.6%
sensitivity and a 100% specificity as reported by the manufacturer.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Specify the limits of detection for each biomarker for the continuous assays</span></span>
<span><span class="va">bounds</span><span class="op">&lt;-</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>biomarker_id<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,name<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lower_bound"</span>,<span class="st">"upper_bound"</span><span class="op">)</span>,value<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>,<span class="cn">Inf</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Specify the observation model </span></span>
<span><span class="va">observation_model</span><span class="op">&lt;-</span><span class="va">observation_model_continuous_bounded_noise</span></span>
<span></span>
<span><span class="co">## Specify assay sensitivity and specificity needed for the observation model</span></span>
<span><span class="va">sensitivity</span><span class="op">&lt;-</span><span class="fl">0.996</span></span>
<span><span class="va">specificity</span><span class="op">&lt;-</span><span class="fl">1</span></span>
<span></span>
<span><span class="co">## Specify observation_times (serological survey sampling design) to observe biomarker 1 (measles IgG antibody titer) across all individuals at the midpoint and the end of the simulation (t=60 and t=120)</span></span>
<span><span class="va">obs1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>i<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="va">N</span>,t<span class="op">=</span><span class="fl">60</span>, b<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">obs2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>i<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="va">N</span>,t<span class="op">=</span><span class="fl">120</span>, b<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">observation_times</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">obs1</span>,<span class="va">obs2</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="optional-arguments">1.8 Optional Arguments<a class="anchor" aria-label="anchor" href="#optional-arguments"></a>
</h2>
<p>Users can specify any additional arguments needed for their models.
Here, we specify an optional argument to print an message to update us
on the progress of the simulation.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## If VERBOSE is specified within runserosim, there will be an update message printed for every multiple of the integer specified.</span></span>
<span><span class="co">## Print a message for every 10 individuals </span></span>
<span><span class="va">VERBOSE</span><span class="op">&lt;-</span><span class="fl">10</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="run-simulation">1.9 Run Simulation<a class="anchor" aria-label="anchor" href="#run-simulation"></a>
</h2>
<p>This is the core simulation where all simulation settings, models and
parameters are specified within the main simulation function. The run
time for this step varies depending on the number of individuals and the
complexities of the specified models. There is a built in
pre-computation step within <em>runserosim</em> where the simulation
attempts to perform as much pre-computation as possible for the exposure
model to speed up the main simulation code. Users can turn off this
pre-computation by setting pre-computation to FALSE within
<em>runserosim</em>.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Run the core simulation and save outputs in "res"</span></span>
<span><span class="va">res</span><span class="op">&lt;-</span> <span class="fu"><a href="../reference/runserosim.html">runserosim</a></span><span class="op">(</span></span>
<span>  <span class="va">simulation_settings</span>,</span>
<span>  <span class="va">demography</span>,</span>
<span>  <span class="va">observation_times</span>,</span>
<span>  <span class="va">foe_pars</span>,</span>
<span>  <span class="va">biomarker_map</span>,</span>
<span>  <span class="va">model_pars</span>,</span>
<span>  <span class="va">exposure_model</span>,</span>
<span>  <span class="va">immunity_model</span>,</span>
<span>  <span class="va">antibody_model</span>,</span>
<span>  <span class="va">observation_model</span>,</span>
<span>  <span class="va">draw_parameters</span>,</span>
<span></span>
<span>  <span class="co">## Specify other arguments needed</span></span>
<span>  VERBOSE<span class="op">=</span><span class="va">VERBOSE</span>,</span>
<span>  bounds<span class="op">=</span><span class="va">bounds</span>,</span>
<span>  max_events<span class="op">=</span><span class="va">max_events</span>,</span>
<span>  vacc_exposures<span class="op">=</span><span class="va">vacc_exposures</span>,</span>
<span>  vacc_age<span class="op">=</span><span class="va">vacc_age</span>,</span>
<span>  sensitivity<span class="op">=</span><span class="va">sensitivity</span>,</span>
<span>  specificity<span class="op">=</span><span class="va">specificity</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Checking for possible pre-computation to save time...</span></span>
<span><span class="co">## Run time can be reduced by pre-computation! Pre-computation would require a maximum of  361  calls to exposure_model as opposed to  24000 </span></span>
<span><span class="co">## Checking if exposure model can be vectorized...</span></span>
<span><span class="co">## Solving the model for one individual without vectorization would take:  0.0005745888  seconds</span></span>
<span><span class="co">## Solving the model for one individual with vectorization would take:  3.218651e-05  seconds</span></span>
<span><span class="co">## Exposure model can be vectorized!</span></span>
<span><span class="co">## Precomputing exposure probabilities...</span></span>
<span><span class="co">## Using pre-computed exposure probabilities</span></span>
<span><span class="co">## Beginning simulation</span></span>
<span><span class="co">## Individual:  10 </span></span>
<span><span class="co">## Individual:  20 </span></span>
<span><span class="co">## Individual:  30 </span></span>
<span><span class="co">## Individual:  40 </span></span>
<span><span class="co">## Individual:  50 </span></span>
<span><span class="co">## Individual:  60 </span></span>
<span><span class="co">## Individual:  70 </span></span>
<span><span class="co">## Individual:  80 </span></span>
<span><span class="co">## Individual:  90 </span></span>
<span><span class="co">## Individual:  100 </span></span>
<span><span class="co">## Simulation complete! Cleaning up...</span></span></code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Note that models and arguments specified earlier in the code can be specified directly within this function.</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="generate-plots">1.10 Generate Plots<a class="anchor" aria-label="anchor" href="#generate-plots"></a>
</h2>
<p>Now that the simulation is complete, let’s plot and examine the
simulation outputs.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Plot biomarker kinetics and exposure histories for 10 individuals </span></span>
<span><span class="fu"><a href="../reference/plot_subset_individuals_history.html">plot_subset_individuals_history</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">biomarker_states</span>, <span class="va">res</span><span class="op">$</span><span class="va">exposure_histories_long</span>, subset<span class="op">=</span><span class="fl">10</span>, <span class="va">demography</span><span class="op">)</span></span></code></pre></div>
<p><img src="case_study_1_measles_files/figure-html/unnamed-chunk-13-1.png" width="576"></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Plot individual probability of exposure for all exposure types.</span></span>
<span><span class="co">## This is the output of the exposure model.</span></span>
<span><span class="co">## Note: All individuals are under the same force of exposure since we specified a simple exposure model and constant foe_pars</span></span>
<span><span class="fu"><a href="../reference/plot_exposure_force.html">plot_exposure_force</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">exposure_force_long</span><span class="op">)</span></span></code></pre></div>
<p><img src="case_study_1_measles_files/figure-html/unnamed-chunk-14-1.png" width="384"></p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Plot individual successful exposure probabilities for all exposure types</span></span>
<span><span class="co">## This is the output of the exposure model multiplied by the output of the immunity model.</span></span>
<span><span class="co">## In other words, this is the probability of exposure event being successful and inducing an immunological response</span></span>
<span><span class="fu"><a href="../reference/plot_exposure_prob.html">plot_exposure_prob</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">exposure_probabilities_long</span><span class="op">)</span></span></code></pre></div>
<p><img src="case_study_1_measles_files/figure-html/unnamed-chunk-15-1.png" width="384"></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Plot individual exposure histories for all exposure types</span></span>
<span><span class="fu"><a href="../reference/plot_exposure_histories.html">plot_exposure_histories</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">exposure_histories_long</span><span class="op">)</span></span></code></pre></div>
<p><img src="case_study_1_measles_files/figure-html/unnamed-chunk-16-1.png" width="384"></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Plot true biomarker quantities for all individuals across the entire simulation period</span></span>
<span><span class="fu"><a href="../reference/plot_biomarker_quantity.html">plot_biomarker_quantity</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">biomarker_states</span><span class="op">)</span></span></code></pre></div>
<p><img src="case_study_1_measles_files/figure-html/unnamed-chunk-17-1.png" width="384"></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Plot the serosurvey results (observed biomarker quantities) at time 60 </span></span>
<span><span class="va">obs60</span><span class="op">&lt;-</span><span class="va">res</span><span class="op">$</span><span class="va">observed_biomarker_states</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">t</span><span class="op">==</span><span class="fl">60</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_obs_biomarkers_one_sample.html">plot_obs_biomarkers_one_sample</a></span><span class="op">(</span><span class="va">obs60</span><span class="op">)</span></span></code></pre></div>
<p><img src="case_study_1_measles_files/figure-html/unnamed-chunk-18-1.png" width="384"></p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Plot the serosurvey results (observed biomarker quantities) at time 120 </span></span>
<span><span class="va">obs120</span><span class="op">&lt;-</span><span class="va">res</span><span class="op">$</span><span class="va">observed_biomarker_states</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">t</span><span class="op">==</span><span class="fl">120</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_obs_biomarkers_one_sample.html">plot_obs_biomarkers_one_sample</a></span><span class="op">(</span><span class="va">obs120</span><span class="op">)</span></span></code></pre></div>
<p><img src="case_study_1_measles_files/figure-html/unnamed-chunk-19-1.png" width="384"></p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Plot both serosurveys paired samples</span></span>
<span><span class="fu"><a href="../reference/plot_obs_biomarkers_paired_sample.html">plot_obs_biomarkers_paired_sample</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">observed_biomarker_states</span><span class="op">)</span></span></code></pre></div>
<p><img src="case_study_1_measles_files/figure-html/unnamed-chunk-20-1.png" width="480"></p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Note that the simulated kinetics parameters are also stored</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">kinetics_parameters</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 7</span></span></span>
<span><span class="co">##       i     t     x     b name                              value realized_value</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>     1    62     2     1 boost_long                  <span style="text-decoration: underline;">1</span>527.          <span style="text-decoration: underline;">1</span>527.      </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>     1    62     2     1 boost_short                 <span style="text-decoration: underline;">1</span>464.          <span style="text-decoration: underline;">1</span>464.      </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>     1    62     2     1 wane_long                      0.000<span style="text-decoration: underline;">845</span>       0.000<span style="text-decoration: underline;">845</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>     1    62     2     1 wane_short                     0.008<span style="text-decoration: underline;">15</span>        0.008<span style="text-decoration: underline;">15</span> </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span>     1    62     2     1 biomarker_ceiling_threshold <span style="text-decoration: underline;">1</span>000           <span style="text-decoration: underline;">1</span>000       </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span>     1    62     2     1 biomarker_ceiling_gradient     0.000<span style="text-decoration: underline;">9</span>         0.000<span style="text-decoration: underline;">9</span></span></span></code></pre>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Amanna2007-pf" class="csl-entry">
Amanna, Ian J, Nichole E Carlson, and Mark K Slifka. 2007.
<span>“Duration of Humoral Immunity to Common Viral and Vaccine
Antigens.”</span> <em>N. Engl. J. Med.</em> 357 (19): 1903–15.
</div>
<div id="ref-Anichini2020-jj" class="csl-entry">
Anichini, Gabriele, Claudia Gandolfo, Simonetta Fabrizi, Giovan Battista
Miceli, Chiara Terrosi, Gianni Gori Savellini, Shibily Prathyumnan,
Daniela Orsi, Giuseppe Battista, and Maria Grazia Cusi. 2020.
<span>“Seroprevalence to Measles Virus After Vaccination or Natural
Infection in an Adult Population, in Italy.”</span> <em>Vaccines
(Basel)</em> 8 (1).
</div>
<div id="ref-Berry2017-ci" class="csl-entry">
Berry, Andrea A, Remon Abu-Elyazeed, Clemente Diaz-Perez, Maurice A
Mufson, Christopher J Harrison, Michael Leonardi, Jerry D Twiggs, et al.
2017. <span>“Two-Year Antibody Persistence in Children Vaccinated at
12-15 Months with a Measles-Mumps-Rubella Virus Vaccine Without Human
Serum Albumin.”</span> <em>Hum. Vaccin. Immunother.</em> 13 (7):
1516–22.
</div>
<div id="ref-Carryn2019-qv" class="csl-entry">
Carryn, Stephane, Muriel Feyssaguet, Michael Povey, and Emmanuel Di
Paolo. 2019. <span>“Long-Term Immunogenicity of Measles, Mumps and
Rubella-Containing Vaccines in Healthy Young Children: A 10-Year
Follow-up.”</span> <em>Vaccine</em> 37 (36): 5323–31.
</div>
<div id="ref-Christenson1994-fj" class="csl-entry">
Christenson, B, and M Böttiger. 1994. <span>“Measles Antibody:
Comparison of Long-Term Vaccination Titres, Early Vaccination Titres and
Naturally Acquired Immunity to and Booster Effects on the Measles
Virus.”</span> <em>Vaccine</em> 12 (2): 129–33.
</div>
<div id="ref-Lyamuya1999-nf" class="csl-entry">
Lyamuya, E F, M I Matee, P Aaby, and F Scheutz. 1999. <span>“Serum
Levels of Measles <span>IgG</span> Antibody Activity in Children Under 5
Years in <span class="nocase">Dar-es-Salaam</span>, Tanzania.”</span>
<em>Ann. Trop. Paediatr.</em> 19 (2): 175–83.
</div>
<div id="ref-Sasaki2019-gl" class="csl-entry">
Sasaki, Hiraku, Tomoko Fukunaga, Ai Asano, Yoshio Suzuki, Yuko
Nakanishi, Junzi Kondo, Hiroki Ishikawa, and Nobuto Shibata. 2019.
<span>“A Survey of <span>Vaccine-Induced</span> Measles <span>IgG</span>
Antibody Titer to Verify Temporal Changes in Response to Measles
Vaccination in Young Adults.”</span> <em>Vaccines (Basel)</em> 7 (3).
</div>
<div id="ref-Thompson2016-ek" class="csl-entry">
Thompson, Kimberly M, and Cassie L Odahowski. 2016. <span>“Systematic
Review of Measles and Rubella Serology Studies.”</span> <em>Risk
Anal.</em> 36 (7): 1459–86.
</div>
<div id="ref-Trevisan2021-of" class="csl-entry">
Trevisan, Andrea, Paola Mason, Annamaria Nicolli, Stefano Maso, Bruno
Scarpa, Angelo Moretto, and Maria Luisa Scapellato. 2021.
<span>“Vaccination and Immunity Toward Measles: A Serosurvey in Future
Healthcare Workers.”</span> <em>Vaccines (Basel)</em> 9 (4).
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Arthur Menezes, James Hay.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
